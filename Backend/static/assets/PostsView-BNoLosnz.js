import{P as w}from"./PostCard-BUF8azPS.js";import{_ as b,u as y,c as d,a as s,g as f,h as p,v as m,q as k,t as a,f as _,o as i,F as h,r as v,s as F,d as g,k as M,e as S,b as x}from"./index-V0CKEUNY.js";const T={name:"CreatePostModal",props:{postToEdit:{type:Object,default:null}},emits:["close","created"],setup(){return{authStore:y()}},data(){return{form:{title:"",content:"",post_type:"thought",track_name:"",artist_name:""},loading:!1,error:null}},methods:{close(){this.$emit("close")},async submitPost(){if(!this.form.title.trim()||!this.form.content.trim()){this.error="Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð²ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ";return}this.loading=!0,this.error=null;try{const r=localStorage.getItem("access_token"),u=await(await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(this.form)})).json();u.success?(this.$emit("created",u.post),this.resetForm()):this.error=u.error||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ð¿Ð¾ÑÑ‚Ð°"}catch(r){this.error="ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐµÑ‚Ð¸. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ.",console.error("Create post error:",r)}finally{this.loading=!1}},resetForm(){this.form={title:"",content:"",post_type:"thought",track_name:"",artist_name:""}}}},V={class:"create-post-modal"},A={class:"modal-header"},U={class:"form-group"},L={class:"form-group"},q={class:"form-group"},N={class:"char-counter"},B={class:"form-group"},I={class:"track-attachment"},Q={class:"form-actions"},j=["disabled"],O={key:0,class:"error-message"};function D(r,t,u,c,e,l){return i(),d("div",V,[s("div",{class:"modal-overlay",onClick:t[9]||(t[9]=(...n)=>l.close&&l.close(...n))},[s("div",{class:"modal-content",onClick:t[8]||(t[8]=f(()=>{},["stop"]))},[s("div",A,[t[10]||(t[10]=s("h2",null,"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ð¾ÑÑ‚",-1)),s("button",{class:"close-btn",onClick:t[0]||(t[0]=(...n)=>l.close&&l.close(...n))},"âœ•")]),s("form",{onSubmit:t[7]||(t[7]=f((...n)=>l.submitPost&&l.submitPost(...n),["prevent"])),class:"create-post-form"},[s("div",U,[t[11]||(t[11]=s("label",{for:"postTitle"},"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº *",-1)),p(s("input",{id:"postTitle","onUpdate:modelValue":t[1]||(t[1]=n=>e.form.title=n),placeholder:"Ðž Ñ‡ÐµÐ¼ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ Ñ€Ð°ÑÑÐºÐ°Ð·Ð°Ñ‚ÑŒ?",required:""},null,512),[[m,e.form.title]])]),s("div",L,[t[13]||(t[13]=s("label",{for:"postType"},"Ð¢Ð¸Ð¿ Ð¿Ð¾ÑÑ‚Ð°",-1)),p(s("select",{id:"postType","onUpdate:modelValue":t[2]||(t[2]=n=>e.form.post_type=n)},[...t[12]||(t[12]=[s("option",{value:"thought"},"ÐœÑ‹ÑÐ»Ð¸",-1),s("option",{value:"review"},"Ð ÐµÑ†ÐµÐ½Ð·Ð¸Ñ",-1),s("option",{value:"news"},"ÐÐ¾Ð²Ð¾ÑÑ‚Ð¸",-1),s("option",{value:"quote"},"Ð¦Ð¸Ñ‚Ð°Ñ‚Ð°",-1)])],512),[[k,e.form.post_type]])]),s("div",q,[t[14]||(t[14]=s("label",{for:"postContent"},"Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ *",-1)),p(s("textarea",{id:"postContent","onUpdate:modelValue":t[3]||(t[3]=n=>e.form.content=n),placeholder:"ÐŸÐ¾Ð´ÐµÐ»Ð¸ÑÑŒ ÑÐ²Ð¾Ð¸Ð¼Ð¸ Ð¼Ñ‹ÑÐ»ÑÐ¼Ð¸...",rows:"6",required:""},null,512),[[m,e.form.content]]),s("div",N,a(e.form.content.length)+"/5000",1)]),s("div",B,[t[15]||(t[15]=s("label",null,"ÐŸÑ€Ð¸ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ Ñ‚Ñ€ÐµÐº",-1)),s("div",I,[p(s("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>e.form.track_name=n),placeholder:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ñ€ÐµÐºÐ°",class:"track-input"},null,512),[[m,e.form.track_name]]),p(s("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>e.form.artist_name=n),placeholder:"Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒ",class:"track-input"},null,512),[[m,e.form.artist_name]])])]),s("div",Q,[s("button",{type:"button",class:"btn btn-secondary",onClick:t[6]||(t[6]=(...n)=>l.close&&l.close(...n))},"ÐžÑ‚Ð¼ÐµÐ½Ð°"),s("button",{type:"submit",class:"btn btn-primary",disabled:e.loading},a(e.loading?"ÐŸÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸Ñ...":"ÐžÐ¿ÑƒÐ±Ð»Ð¸ÐºÐ¾Ð²Ð°Ñ‚ÑŒ"),9,j)]),e.error?(i(),d("div",O,a(e.error),1)):_("",!0)],32)])])])}const J=b(T,[["render",D],["__scopeId","data-v-51f8209f"]]),z={name:"PostsView",components:{PostCard:w,CreatePostModal:J},data(){return{searchQuery:"",activeFilter:"all",showCreateModal:!1,currentPage:1,postsPerPage:10,posts:[],filters:[{id:"all",label:"Ð’ÑÐµ"},{id:"reviews",label:"Ð ÐµÑ†ÐµÐ½Ð·Ð¸Ð¸"},{id:"thoughts",label:"ÐœÑ‹ÑÐ»Ð¸"},{id:"quotes",label:"Ð¦Ð¸Ñ‚Ð°Ñ‚Ñ‹"},{id:"news",label:"ÐÐ¾Ð²Ð¾ÑÑ‚Ð¸"}],trendingTags:[{name:"Ð½Ð¾Ð²Ð¸Ð½ÐºÐ°",count:245},{name:"Ñ…Ð¸Ð¿Ñ…Ð¾Ð¿",count:189},{name:"Ñ€Ð¾Ðº",count:167},{name:"Ð¾Ð±Ð·Ð¾Ñ€",count:142},{name:"ÐºÐ¾Ð½Ñ†ÐµÑ€Ñ‚",count:128}],popularAuthors:[{id:1,name:"ÐÐ»ÐµÐºÑÐµÐ¹ Ð Ð¾ÐºÐµÑ€",avatar:"https://i.pravatar.cc/150?img=12",posts:45,isFollowing:!1},{id:2,name:"ÐœÐ°Ñ€Ð¸Ñ ÐœÐµÐ»Ð¾Ð¼Ð°Ð½Ð°",avatar:"https://i.pravatar.cc/150?img=5",posts:32,isFollowing:!0},{id:3,name:"DJ ÐŸÐµÑ‚Ñ€Ð¾Ð²Ð¸Ñ‡",avatar:"https://i.pravatar.cc/150?img=8",posts:28,isFollowing:!1}],stats:{totalPosts:12560,activeUsers:842,dailyPosts:156}}},computed:{currentUserAvatar(){return JSON.parse(localStorage.getItem("user")||"{}").avatar||"https://i.pravatar.cc/150?img=1"},filteredPosts(){let r=this.posts;if(this.searchQuery){const c=this.searchQuery.toLowerCase();r=r.filter(e=>e.title.toLowerCase().includes(c)||e.content.toLowerCase().includes(c)||e.author.name.toLowerCase().includes(c))}this.activeFilter!=="all"&&(r=r.filter(c=>c.type===this.activeFilter));const t=(this.currentPage-1)*this.postsPerPage,u=t+this.postsPerPage;return r.slice(t,u)},totalPages(){return Math.ceil(this.posts.length/this.postsPerPage)}},async mounted(){await this.loadPosts()},methods:{async loadPosts(){try{const t=await(await fetch("/api/posts")).json();t.success&&(this.posts=t.posts)}catch(r){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¿Ð¾ÑÑ‚Ð¾Ð²:",r)}},handleSearch(){this.currentPage=1},applyFilter(r){this.activeFilter=r,this.currentPage=1},followAuthor(r){const t=this.popularAuthors.find(u=>u.id===r);t&&(t.isFollowing=!t.isFollowing)},handleLike(r){console.log("Ð›Ð°Ð¹Ðº Ð¿Ð¾ÑÑ‚Ð°:",r)},handleComment(r){this.$router.push(`/post/${r}`)},handlePostCreated(r){this.posts.unshift(r),this.showCreateModal=!1},prevPage(){this.currentPage>1&&(this.currentPage--,window.scrollTo(0,0))},nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,window.scrollTo(0,0))}}},E={class:"posts-view"},G={class:"posts-header"},H={class:"filters-bar"},K={class:"search-box"},R={class:"filter-buttons"},W=["onClick"],X={class:"posts-content"},Y={class:"sidebar"},Z={class:"sidebar-section"},$={class:"trending-tags"},tt={class:"sidebar-section"},st={class:"popular-authors"},et=["src"],ot={class:"author-info"},rt=["onClick"],lt={class:"sidebar-section"},nt={class:"stats"},at={class:"stat-item"},it={class:"stat-value"},dt={class:"stat-item"},ut={class:"stat-value"},ct={class:"stat-item"},pt={class:"stat-value"},mt={class:"posts-feed"},ht={class:"create-post-card"},vt={class:"create-post-header"},ft=["src"],gt={class:"create-post-actions"},bt={class:"posts-list"},_t={class:"pagination"},Pt=["disabled"],Ct={class:"page-info"},wt=["disabled"];function yt(r,t,u,c,e,l){const n=g("PostCard"),P=g("CreatePostModal");return i(),d("div",E,[s("div",G,[t[11]||(t[11]=s("h1",null,"Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð¾ Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð½Ñ‚Ð¾Ð²",-1)),t[12]||(t[12]=s("p",null,"Ð§Ð¸Ñ‚Ð°Ð¹, Ð¾Ð±Ñ‰Ð°Ð¹ÑÑ Ð¸ Ð´ÐµÐ»Ð¸ÑÑŒ Ð¼ÑƒÐ·Ñ‹ÐºÐ¾Ð¹",-1)),s("div",H,[s("div",K,[p(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>e.searchQuery=o),placeholder:"ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ÑÑ‚Ð¾Ð², Ñ‚Ñ€ÐµÐºÐ¾Ð², Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÐµÐ¹...",onInput:t[1]||(t[1]=(...o)=>l.handleSearch&&l.handleSearch(...o))},null,544),[[m,e.searchQuery]]),t[10]||(t[10]=s("span",{class:"search-icon"},"ðŸ”",-1))]),s("div",R,[(i(!0),d(h,null,v(e.filters,o=>(i(),d("button",{key:o.id,class:M(["filter-btn",{active:e.activeFilter===o.id}]),onClick:C=>l.applyFilter(o.id)},a(o.label),11,W))),128))])])]),s("div",X,[s("aside",Y,[s("div",Z,[t[13]||(t[13]=s("h3",null,"Ð¢Ñ€ÐµÐ½Ð´Ñ‹",-1)),s("div",$,[(i(!0),d(h,null,v(e.trendingTags,o=>(i(),d("span",{class:"trend-tag",key:o.name},[S(" #"+a(o.name)+" ",1),s("small",null,a(o.count),1)]))),128))])]),s("div",tt,[t[14]||(t[14]=s("h3",null,"ÐŸÐ¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ð°Ð²Ñ‚Ð¾Ñ€Ñ‹",-1)),s("div",st,[(i(!0),d(h,null,v(e.popularAuthors,o=>(i(),d("div",{class:"author-card",key:o.id},[s("img",{src:o.avatar,alt:"Avatar"},null,8,et),s("div",ot,[s("strong",null,a(o.name),1),s("span",null,a(o.posts)+" Ð¿Ð¾ÑÑ‚Ð¾Ð²",1)]),s("button",{class:"follow-btn",onClick:C=>l.followAuthor(o.id)},a(o.isFollowing?"âœ“ ÐŸÐ¾Ð´Ð¿Ð¸ÑÐ°Ð½":"ÐŸÐ¾Ð´Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ"),9,rt)]))),128))])]),s("div",lt,[t[18]||(t[18]=s("h3",null,"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°",-1)),s("div",nt,[s("div",at,[s("span",it,a(e.stats.totalPosts),1),t[15]||(t[15]=s("span",{class:"stat-label"},"ÐŸÐ¾ÑÑ‚Ð¾Ð²",-1))]),s("div",dt,[s("span",ut,a(e.stats.activeUsers),1),t[16]||(t[16]=s("span",{class:"stat-label"},"ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ…",-1))]),s("div",ct,[s("span",pt,a(e.stats.dailyPosts),1),t[17]||(t[17]=s("span",{class:"stat-label"},"Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ",-1))])])])]),s("main",mt,[s("div",ht,[s("div",vt,[s("img",{src:l.currentUserAvatar,class:"user-avatar",alt:"Avatar"},null,8,ft),s("input",{type:"text",placeholder:"Ðž Ñ‡ÐµÐ¼ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ Ñ€Ð°ÑÑÐºÐ°Ð·Ð°Ñ‚ÑŒ?",onClick:t[2]||(t[2]=o=>e.showCreateModal=!0)})]),s("div",gt,[s("button",{class:"action-btn",onClick:t[3]||(t[3]=o=>e.showCreateModal=!0)},"ðŸ“ Ð¢ÐµÐºÑÑ‚"),s("button",{class:"action-btn",onClick:t[4]||(t[4]=o=>e.showCreateModal=!0)},"ðŸŽµ Ð¢Ñ€ÐµÐº"),s("button",{class:"action-btn",onClick:t[5]||(t[5]=o=>e.showCreateModal=!0)},"ðŸ–¼ï¸ Ð¤Ð¾Ñ‚Ð¾"),s("button",{class:"action-btn",onClick:t[6]||(t[6]=o=>e.showCreateModal=!0)},"ðŸŽ¥ Ð’Ð¸Ð´ÐµÐ¾")])]),s("div",bt,[(i(!0),d(h,null,v(l.filteredPosts,o=>(i(),d("div",{key:o.id,class:"post-item"},[x(n,{post:o,onLike:l.handleLike,onComment:l.handleComment},null,8,["post","onLike","onComment"])]))),128))]),s("div",_t,[s("button",{class:"pagination-btn",disabled:e.currentPage===1,onClick:t[7]||(t[7]=(...o)=>l.prevPage&&l.prevPage(...o))}," â† ÐÐ°Ð·Ð°Ð´ ",8,Pt),s("span",Ct," Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° "+a(e.currentPage)+" Ð¸Ð· "+a(l.totalPages),1),s("button",{class:"pagination-btn",disabled:e.currentPage===l.totalPages,onClick:t[8]||(t[8]=(...o)=>l.nextPage&&l.nextPage(...o))}," Ð”Ð°Ð»ÐµÐµ â†’ ",8,wt)])])]),e.showCreateModal?(i(),F(P,{key:0,onClose:t[9]||(t[9]=o=>e.showCreateModal=!1),onCreated:l.handlePostCreated},null,8,["onCreated"])):_("",!0)])}const Mt=b(z,[["render",yt],["__scopeId","data-v-fe2c4451"]]);export{Mt as default};
