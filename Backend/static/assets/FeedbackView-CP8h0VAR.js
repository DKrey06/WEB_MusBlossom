import{_ as b,c as n,a as s,g,h as r,v as a,y as d,t as f,f as p,o as m}from"./index-V0CKEUNY.js";const h={name:"FeedbackView",data(){return{form:{name:"",email:"",type:"suggestion",subject:"",message:"",attachment:null,submitting:!1},successMessage:"",errorMessage:""}},computed:{formValid(){return this.form.name.trim()&&this.form.email.trim()&&this.form.subject.trim()&&this.form.message.trim()&&this.validateEmail(this.form.email)}},methods:{validateEmail(i){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)},handleFileUpload(i){const e=i.target.files[0];if(e){if(e.size>5*1024*1024){this.errorMessage="Файл слишком большой. Максимальный размер: 5MB",this.$refs.fileInput.value="";return}this.form.attachment=e}},async submitFeedback(){if(!this.formValid){this.errorMessage="Заполните все обязательные поля правильно";return}this.form.submitting=!0,this.successMessage="",this.errorMessage="";const i=new FormData;i.append("name",this.form.name),i.append("email",this.form.email),i.append("type",this.form.type),i.append("subject",this.form.subject),i.append("message",this.form.message),this.form.attachment&&i.append("attachment",this.form.attachment);try{const u=await(await fetch("/api/feedback",{method:"POST",body:i})).json();u.success?(this.successMessage="Спасибо за ваше сообщение! Мы свяжемся с вами в ближайшее время.",this.resetForm()):this.errorMessage=u.error||"Произошла ошибка при отправке"}catch(e){console.error("Feedback submission error:",e),this.errorMessage="Ошибка соединения. Пожалуйста, попробуйте позже."}finally{this.form.submitting=!1}},resetForm(){this.form.name="",this.form.email="",this.form.type="suggestion",this.form.subject="",this.form.message="",this.form.attachment=null,this.form.submitting=!1,this.errorMessage="",this.$refs.fileInput&&(this.$refs.fileInput.value="")}}},c={class:"feedback-view"},y={class:"feedback-container"},v={class:"feedback-form"},_={class:"form-group"},k=["disabled"],M={class:"form-group"},V=["disabled"],F={class:"form-group"},U={class:"type-options"},j={class:"type-option"},w=["disabled"],x={class:"type-option"},q=["disabled"],B={class:"type-option"},I=["disabled"],D={class:"type-option"},E=["disabled"],C={class:"form-group"},S=["disabled"],N={class:"form-group"},T=["disabled"],z={class:"form-group"},O={class:"attachment-label"},P=["disabled"],R={key:0,class:"attachment-name"},A={class:"form-actions"},G=["disabled"],H={key:0,class:"loading"},J={key:1},K=["disabled"],L={key:0,class:"success-message"},Q={key:1,class:"error-message"};function W(i,e,u,X,t,l){return m(),n("div",c,[e[22]||(e[22]=s("div",{class:"feedback-header"},[s("h1",null,"Обратная связь"),s("p",null,"Мы ценим ваше мнение. Пожалуйста, заполните форму ниже")],-1)),s("div",y,[s("div",v,[s("form",{onSubmit:e[10]||(e[10]=g((...o)=>l.submitFeedback&&l.submitFeedback(...o),["prevent"]))},[s("div",_,[e[11]||(e[11]=s("label",{for:"name"},"Имя *",-1)),r(s("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>t.form.name=o),type:"text",placeholder:"Ваше имя",required:"",disabled:t.form.submitting},null,8,k),[[a,t.form.name]])]),s("div",M,[e[12]||(e[12]=s("label",{for:"email"},"Email *",-1)),r(s("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>t.form.email=o),type:"email",placeholder:"your@email.com",required:"",disabled:t.form.submitting},null,8,V),[[a,t.form.email]])]),s("div",F,[e[17]||(e[17]=s("label",null,"Тип обращения *",-1)),s("div",U,[s("label",j,[r(s("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=o=>t.form.type=o),value:"suggestion",disabled:t.form.submitting},null,8,w),[[d,t.form.type]]),e[13]||(e[13]=s("span",null,"Предложение",-1))]),s("label",x,[r(s("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=o=>t.form.type=o),value:"bug",disabled:t.form.submitting},null,8,q),[[d,t.form.type]]),e[14]||(e[14]=s("span",null,"Ошибка",-1))]),s("label",B,[r(s("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=o=>t.form.type=o),value:"question",disabled:t.form.submitting},null,8,I),[[d,t.form.type]]),e[15]||(e[15]=s("span",null,"Вопрос",-1))]),s("label",D,[r(s("input",{type:"radio","onUpdate:modelValue":e[5]||(e[5]=o=>t.form.type=o),value:"other",disabled:t.form.submitting},null,8,E),[[d,t.form.type]]),e[16]||(e[16]=s("span",null,"Другое",-1))])])]),s("div",C,[e[18]||(e[18]=s("label",{for:"subject"},"Тема *",-1)),r(s("input",{id:"subject","onUpdate:modelValue":e[6]||(e[6]=o=>t.form.subject=o),type:"text",placeholder:"Краткое описание",required:"",disabled:t.form.submitting},null,8,S),[[a,t.form.subject]])]),s("div",N,[e[19]||(e[19]=s("label",{for:"message"},"Сообщение *",-1)),r(s("textarea",{id:"message","onUpdate:modelValue":e[7]||(e[7]=o=>t.form.message=o),placeholder:"Подробно опишите ваше обращение...",rows:"6",required:"",disabled:t.form.submitting},null,8,T),[[a,t.form.message]])]),s("div",z,[s("label",O,[s("input",{type:"file",ref:"fileInput",onChange:e[8]||(e[8]=(...o)=>l.handleFileUpload&&l.handleFileUpload(...o)),disabled:t.form.submitting,style:{display:"none"}},null,40,P),e[20]||(e[20]=s("span",{class:"attachment-btn"},"Прикрепить файл",-1)),t.form.attachment?(m(),n("span",R,f(t.form.attachment.name),1)):p("",!0)]),e[21]||(e[21]=s("small",null,"Максимальный размер файла: 5MB",-1))]),s("div",A,[s("button",{type:"submit",class:"btn btn-primary",disabled:t.form.submitting||!l.formValid},[t.form.submitting?(m(),n("span",H,"Отправка...")):(m(),n("span",J,"Отправить"))],8,G),s("button",{type:"button",class:"btn btn-secondary",onClick:e[9]||(e[9]=(...o)=>l.resetForm&&l.resetForm(...o)),disabled:t.form.submitting}," Очистить ",8,K)])],32)])]),t.successMessage?(m(),n("div",L,f(t.successMessage),1)):p("",!0),t.errorMessage?(m(),n("div",Q,f(t.errorMessage),1)):p("",!0)])}const Z=b(h,[["render",W],["__scopeId","data-v-81078ab9"]]);export{Z as default};
