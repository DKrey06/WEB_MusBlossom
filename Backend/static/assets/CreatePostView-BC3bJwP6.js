import{_ as f,c as a,a as e,g as b,h as p,v as h,t as n,F as m,r as v,f as u,x as k,o as r,y as _,e as y}from"./index-V0CKEUNY.js";const I={name:"CreatePostView",data(){return{post:{title:"",content:"",post_type:"thought",track_name:"",artist_name:"",track_cover:"",tags:[],image:null},creating:!1,postTypes:[{value:"thought",label:"–ú—ã—Å–ª–∏"},{value:"review",label:"–†–µ—Ü–µ–Ω–∑–∏—è"},{value:"news",label:"–ù–æ–≤–æ—Å—Ç–∏"},{value:"quote",label:"–¶–∏—Ç–∞—Ç–∞"},{value:"photo",label:"–§–æ—Ç–æ"}],trackSearch:"",trackResults:[],tagInput:"",tagSuggestions:[],allTags:["–†–æ–∫","–ü–æ–ø","–•–∏–ø-—Ö–æ–ø","–î–∂–∞–∑","–ö–ª–∞—Å—Å–∏–∫–∞","–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞","–ò–Ω–¥–∏","–ú–µ—Ç–∞–ª","–§–æ–ª–∫","R&B","–°–æ—É–ª","–†–µ–≥–≥–∏","–ù–æ–≤–∏–Ω–∫–∞","–ö–æ–Ω—Ü–µ—Ä—Ç","–ê–ª—å–±–æ–º","–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å"]}},watch:{tagInput(i){i.trim()?this.tagSuggestions=this.allTags.filter(t=>t.toLowerCase().includes(i.toLowerCase())&&!this.post.tags.includes(t)):this.tagSuggestions=[]}},methods:{async createPost(){this.creating=!0;try{const i=localStorage.getItem("access_token"),t=new FormData;t.append("title",this.post.title),t.append("content",this.post.content),t.append("post_type",this.post.post_type),t.append("track_name",this.post.track_name),t.append("artist_name",this.post.artist_name),t.append("tags",JSON.stringify(this.post.tags)),this.$refs.fileInput.files[0]&&t.append("image",this.$refs.fileInput.files[0]);const c=await(await fetch("http://localhost:5000/api/posts",{method:"POST",headers:{Authorization:`Bearer ${i}`},body:t})).json();c.success?this.$router.push("/posts"):alert("–û—à–∏–±–∫–∞: "+c.error)}catch(i){console.error("Error creating post:",i),alert("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞")}finally{this.creating=!1}},searchTracks(){if(this.trackSearch.length<2){this.trackResults=[];return}this.trackResults=[{id:1,title:"Blinding Lights",artist:"The Weeknd",cover:"https://i.scdn.co/image/ab67616d00001e02/86a0f12c8d1c65b6e6c8b1a0f2c5e8b1d5b3a8f2"},{id:2,title:"Levitating",artist:"Dua Lipa",cover:"https://i.scdn.co/image/ab67616d00001e02/f2b8b5b5f5b5f5b5f5b5f5b5f5b5f5b5f5b5f5b5"},{id:3,title:"Stay",artist:"The Kid LAROI, Justin Bieber",cover:"https://i.scdn.co/image/ab67616d00001e02/6e0b5b8b9c5b8b8b8b8b8b8b8b8b8b8b8b8b8b8"}]},selectTrack(i){this.post.track_name=i.title,this.post.artist_name=i.artist,this.post.track_cover=i.cover,this.trackSearch="",this.trackResults=[]},removeTrack(){this.post.track_name="",this.post.artist_name="",this.post.track_cover=""},addTag(){const i=this.tagInput.trim();i&&!this.post.tags.includes(i)&&(this.post.tags.push(i),this.tagInput="",this.tagSuggestions=[])},addTagFromSuggestion(i){this.post.tags.includes(i)||(this.post.tags.push(i),this.tagInput="",this.tagSuggestions=[])},removeTag(i){this.post.tags=this.post.tags.filter(t=>t!==i)},triggerFileInput(){this.$refs.fileInput.click()},handleImageUpload(i){const t=i.target.files[0];if(t){if(t.size>5*1024*1024){alert("–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å–∏–º—É–º 5 MB)");return}const d=new FileReader;d.onload=c=>{this.post.image=c.target.result},d.readAsDataURL(t)}},removeImage(){this.post.image=null,this.$refs.fileInput.value=null},cancelCreate(){this.post.title||this.post.content?confirm("–û—Ç–º–µ–Ω–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞? –í—Å–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.")&&this.$router.go(-1):this.$router.go(-1)}}},T={class:"create-post-view"},C={class:"create-container"},S={class:"form-group"},w={class:"form-group"},R={class:"char-counter"},x={class:"form-group"},B={class:"type-options"},F=["value"],P={key:0,class:"form-group"},U={class:"track-search"},V={key:0,class:"track-results"},L=["onClick"],D=["src","alt"],M={class:"track-info"},N={class:"track-title"},q={class:"track-artist"},A={key:0,class:"selected-track"},E={class:"track-display"},J=["src"],K={class:"track-details"},O={key:0},z={class:"form-group"},G={class:"tags-input"},j={class:"selected-tags"},W=["onClick"],H={key:0,class:"tag-suggestions"},Q=["onClick"],X={class:"form-group"},Y={class:"image-upload"},Z={key:1,class:"image-preview"},$=["src"],tt={class:"form-actions"},et=["disabled"];function st(i,t,d,c,o,l){return r(),a("div",T,[t[20]||(t[20]=e("div",{class:"create-header"},[e("h1",null,"–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç"),e("p",null,"–ü–æ–¥–µ–ª–∏—Å—å —Å–≤–æ–∏–º–∏ –º—ã—Å–ª—è–º–∏ –∏–ª–∏ –º—É–∑—ã–∫–æ–π")],-1)),e("div",C,[e("form",{onSubmit:t[12]||(t[12]=b((...s)=>l.createPost&&l.createPost(...s),["prevent"])),class:"post-form"},[e("div",S,[t[13]||(t[13]=e("label",{for:"post-title"},"–ó–∞–≥–æ–ª–æ–≤–æ–∫ *",-1)),p(e("input",{type:"text",id:"post-title","onUpdate:modelValue":t[0]||(t[0]=s=>o.post.title=s),placeholder:"–û —á–µ–º —Ö–æ—á–µ—à—å —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å?",required:""},null,512),[[h,o.post.title]])]),e("div",w,[t[14]||(t[14]=e("label",{for:"post-content"},"–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ *",-1)),p(e("textarea",{id:"post-content","onUpdate:modelValue":t[1]||(t[1]=s=>o.post.content=s),placeholder:"–ù–∞–ø–∏—à–∏ —Å–≤–æ–π –ø–æ—Å—Ç –∑–¥–µ—Å—å...",rows:"8",required:""},null,512),[[h,o.post.content]]),e("div",R,n(o.post.content.length)+"/5000",1)]),e("div",x,[t[15]||(t[15]=e("label",null,"–¢–∏–ø –ø–æ—Å—Ç–∞",-1)),e("div",B,[(r(!0),a(m,null,v(o.postTypes,s=>(r(),a("label",{key:s.value,class:"type-option"},[p(e("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=g=>o.post.post_type=g),value:s.value},null,8,F),[[_,o.post.post_type]]),e("span",null,n(s.label),1)]))),128))])]),o.post.post_type==="review"?(r(),a("div",P,[t[16]||(t[16]=e("label",null,"–ü—Ä–∏–≤—è–∑–∞—Ç—å —Ç—Ä–µ–∫",-1)),e("div",U,[p(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>o.trackSearch=s),placeholder:"–ü–æ–∏—Å–∫ —Ç—Ä–µ–∫–∞...",onInput:t[4]||(t[4]=(...s)=>l.searchTracks&&l.searchTracks(...s))},null,544),[[h,o.trackSearch]]),o.trackResults.length?(r(),a("div",V,[(r(!0),a(m,null,v(o.trackResults,s=>(r(),a("div",{key:s.id,class:"track-result",onClick:g=>l.selectTrack(s)},[e("img",{src:s.cover,alt:s.title,class:"track-cover"},null,8,D),e("div",M,[e("span",N,n(s.title),1),e("span",q,n(s.artist),1)])],8,L))),128))])):u("",!0)]),o.post.track_name?(r(),a("div",A,[e("div",E,[e("img",{src:o.post.track_cover||"https://via.placeholder.com/50",alt:"Cover",class:"track-cover"},null,8,J),e("div",K,[e("strong",null,n(o.post.track_name),1),o.post.artist_name?(r(),a("span",O,n(o.post.artist_name),1)):u("",!0)]),e("button",{type:"button",class:"remove-track",onClick:t[5]||(t[5]=(...s)=>l.removeTrack&&l.removeTrack(...s))},"√ó")])])):u("",!0)])):u("",!0),e("div",z,[t[17]||(t[17]=e("label",null,"–¢–µ–≥–∏",-1)),e("div",G,[e("div",j,[(r(!0),a(m,null,v(o.post.tags,s=>(r(),a("span",{key:s,class:"tag"},[y(n(s)+" ",1),e("button",{type:"button",onClick:g=>l.removeTag(s),class:"remove-tag"},"√ó",8,W)]))),128))]),p(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=s=>o.tagInput=s),placeholder:"–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–≥–∏ (–Ω–∞–∂–º–∏—Ç–µ Enter)...",onKeydown:t[7]||(t[7]=k(b((...s)=>l.addTag&&l.addTag(...s),["prevent"]),["enter"]))},null,544),[[h,o.tagInput]]),o.tagSuggestions.length?(r(),a("div",H,[(r(!0),a(m,null,v(o.tagSuggestions,s=>(r(),a("div",{key:s,class:"suggestion",onClick:g=>l.addTagFromSuggestion(s)},n(s),9,Q))),128))])):u("",!0)])]),e("div",X,[t[19]||(t[19]=e("label",null,"–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",-1)),e("div",Y,[e("input",{type:"file",ref:"fileInput",accept:"image/*",onChange:t[8]||(t[8]=(...s)=>l.handleImageUpload&&l.handleImageUpload(...s)),style:{display:"none"}},null,544),o.post.image?(r(),a("div",Z,[e("img",{src:o.post.image,alt:"Preview"},null,8,$),e("button",{type:"button",class:"remove-image",onClick:t[10]||(t[10]=(...s)=>l.removeImage&&l.removeImage(...s))},"√ó")])):(r(),a("div",{key:0,class:"upload-placeholder",onClick:t[9]||(t[9]=(...s)=>l.triggerFileInput&&l.triggerFileInput(...s))},[...t[18]||(t[18]=[e("span",{class:"upload-icon"},"üì∑",-1),e("span",null,"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ",-1),e("small",null,"–î–æ 5 MB, —Ñ–æ—Ä–º–∞—Ç—ã: JPG, PNG",-1)])]))])]),e("div",tt,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[11]||(t[11]=(...s)=>l.cancelCreate&&l.cancelCreate(...s))},"–û—Ç–º–µ–Ω–∞"),e("button",{type:"submit",class:"btn btn-primary",disabled:o.creating},n(o.creating?"–°–æ–∑–¥–∞–Ω–∏–µ...":"–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å"),9,et)])],32)])])}const it=f(I,[["render",st],["__scopeId","data-v-c759b43e"]]);export{it as default};
