import{_ as f,c as d,a as s,n as h,t as o,g as c,F as g,r as _,l as u,i as k,v,y as C,o as m}from"./index-CAI9DG47.js";const y={name:"PostCard",props:{post:{type:Object,required:!0,default:()=>({})}},data(){return{showComments:!1,newComment:""}},computed:{hasTrack(){const t=this.post||{};return t.track_name||t.track?.name||t.artist_name||t.track?.artist}},methods:{getAuthorDisplayName(t){return t&&(t.name||t.username||t.author_name)||"–ê–Ω–æ–Ω–∏–º"},getAuthorInitial(t){return this.getAuthorDisplayName(t).charAt(0).toUpperCase()},isAuthorVerified(t){return t&&(t.isVerified||t.is_verified)||!1},getAvatarStyle(t){const a=this.getAuthorDisplayName(t),i=["linear-gradient(135deg, #8a2be2, #4b0082)","linear-gradient(135deg, #1e90ff, #00bfff)","linear-gradient(135deg, #ff4757, #ff3838)","linear-gradient(135deg, #2ed573, #1dd1a1)","linear-gradient(135deg, #ffa502, #ff9f1a)","linear-gradient(135deg, #7158e2, #574b90)"];let r=0;for(let e=0;e<a.length;e++)r=a.charCodeAt(e)+((r<<5)-r);const l=Math.abs(r)%i.length;return{background:i[l]}},getTrackName(t){return t.track?.name||t.track_name||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç—Ä–µ–∫"},getTrackArtist(t){return t.track?.artist||t.artist_name||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å"},getPostType(t){const a={thought:"–ú—ã—Å–ª–∏",review:"–†–µ—Ü–µ–Ω–∑–∏—è",news:"–ù–æ–≤–æ—Å—Ç–∏",quote:"–¶–∏—Ç–∞—Ç–∞",photo:"–§–æ—Ç–æ"},i=t.type||t.post_type||"thought";return a[i]||i},getPostTags(t){return t.tags||[]},getPostMedia(t){return t.media||t.media_url||null},getLikesCount(t){return t.likes_count||t.likesCount||0},getCommentsCount(t){return t.comments_count||t.commentsCount||0},getIsLiked(t){return t.is_liked||t.isLiked||!1},getIsSaved(t){return t.is_saved||t.isSaved||!1},getIsFeatured(t){return t.is_featured||t.isFeatured||!1},getPostComments(t){return t.comments||[]},formatTime(t){if(!t)return"–Ω–µ–¥–∞–≤–Ω–æ";const a=new Date(t),r=new Date-a,l=Math.floor(r/6e4),e=Math.floor(r/36e5),n=Math.floor(r/864e5);return l<1?"—Ç–æ–ª—å–∫–æ —á—Ç–æ":l<60?`${l} –º–∏–Ω –Ω–∞–∑–∞–¥`:e<24?`${e} —á –Ω–∞–∑–∞–¥`:n<7?`${n} –¥ –Ω–∞–∑–∞–¥`:a.toLocaleDateString("ru-RU")},getCommentTime(t){return t.time||this.formatTime(t.created_at)||"–Ω–µ–¥–∞–≤–Ω–æ"},toggleLike(){this.$emit("like",this.post.id)},toggleComments(){this.showComments=!this.showComments,this.showComments||this.$emit("comment",this.post.id)},sharePost(){navigator.share?navigator.share({title:this.post.title,text:this.post.content,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!"))},toggleSave(){this.$emit("save",this.post.id)},playTrack(t){const a={name:this.getTrackName(t),artist:this.getTrackArtist(t),album_art:t.track?.album_art||t.album_art_url};this.$emit("play",a)},showMedia(){const t=this.getPostMedia(this.post);t&&this.$emit("show-media",t)},addComment(){this.newComment.trim()&&(this.$emit("comment",{postId:this.post.id,content:this.newComment}),this.newComment="")},toggleOptions(){this.$emit("options",this.post.id)}}},b={class:"post-header"},w={class:"post-meta"},T={class:"author-info"},A={class:"author-name"},P={key:0,class:"author-badge"},M={class:"post-time"},S={class:"post-content"},I={class:"post-title"},x={class:"post-text"},D={key:0,class:"track-preview"},L={class:"track-info"},N={class:"track-details"},p={class:"post-tags"},V={class:"post-type"},F={key:1,class:"post-media"},O=["src"],U={class:"post-actions"},B={key:0,class:"comments-section"},q={class:"comments-list"},z={class:"comment-content"},K={class:"comment-header"},j={class:"comment-author"},E={class:"comment-time"},R={class:"comment-text"},G={class:"add-comment"};function H(t,a,i,r,l,e){return m(),d("div",{class:u(["post-card",{featured:i.post.isFeatured}])},[s("div",b,[s("div",{class:"author-avatar-placeholder",style:h(e.getAvatarStyle(i.post.author))},o(e.getAuthorInitial(i.post.author)),5),s("div",w,[s("div",T,[s("span",A,o(e.getAuthorDisplayName(i.post.author)),1),e.isAuthorVerified(i.post.author)?(m(),d("span",P,"‚úì")):c("",!0)]),s("span",M,o(e.formatTime(i.post.created_at)),1)]),s("button",{class:"more-btn",onClick:a[0]||(a[0]=(...n)=>e.toggleOptions&&e.toggleOptions(...n))},"‚ãÆ")]),s("div",S,[s("h3",I,o(i.post.title||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"),1),s("p",x,o(i.post.content||""),1),e.hasTrack?(m(),d("div",D,[s("div",L,[a[10]||(a[10]=s("div",{class:"album-art-placeholder"},"üéµ",-1)),s("div",N,[s("strong",null,o(e.getTrackName(i.post)),1),s("span",null,o(e.getTrackArtist(i.post)),1)])]),s("button",{class:"play-btn",onClick:a[1]||(a[1]=n=>e.playTrack(i.post))},"‚ñ∂Ô∏è")])):c("",!0),s("div",p,[s("span",V,o(e.getPostType(i.post)),1),(m(!0),d(g,null,_(e.getPostTags(i.post),n=>(m(),d("span",{class:"tag",key:n}," #"+o(n),1))),128))]),e.getPostMedia(i.post)?(m(),d("div",F,[s("img",{src:e.getPostMedia(i.post),alt:"Media",onClick:a[2]||(a[2]=(...n)=>e.showMedia&&e.showMedia(...n))},null,8,O)])):c("",!0)]),s("div",U,[s("button",{class:u(["action-btn like-btn",{liked:e.getIsLiked(i.post)}]),onClick:a[3]||(a[3]=(...n)=>e.toggleLike&&e.toggleLike(...n))}," ‚ù§Ô∏è "+o(e.getLikesCount(i.post)),3),s("button",{class:"action-btn comment-btn",onClick:a[4]||(a[4]=(...n)=>e.toggleComments&&e.toggleComments(...n))}," üí¨ "+o(e.getCommentsCount(i.post)),1),s("button",{class:"action-btn share-btn",onClick:a[5]||(a[5]=(...n)=>e.sharePost&&e.sharePost(...n))},"‚Ü™Ô∏è –ü–æ–¥–µ–ª–∏—Ç—å—Å—è"),s("button",{class:u(["action-btn save-btn",{saved:e.getIsSaved(i.post)}]),onClick:a[6]||(a[6]=(...n)=>e.toggleSave&&e.toggleSave(...n))},o(e.getIsSaved(i.post)?"‚òÖ":"‚òÜ"),3)]),l.showComments?(m(),d("div",B,[s("div",q,[(m(!0),d(g,null,_(e.getPostComments(i.post),n=>(m(),d("div",{key:n.id,class:"comment"},[s("div",{class:"comment-avatar-placeholder",style:h(e.getAvatarStyle(n.author))},o(e.getAuthorInitial(n.author)),5),s("div",z,[s("div",K,[s("span",j,o(e.getAuthorDisplayName(n.author)),1),s("span",E,o(e.getCommentTime(n)),1)]),s("p",R,o(n.text||n.content||""),1)])]))),128))]),s("div",G,[k(s("input",{type:"text","onUpdate:modelValue":a[7]||(a[7]=n=>l.newComment=n),placeholder:"–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...",onKeyup:a[8]||(a[8]=C((...n)=>e.addComment&&e.addComment(...n),["enter"]))},null,544),[[v,l.newComment]]),s("button",{onClick:a[9]||(a[9]=(...n)=>e.addComment&&e.addComment(...n))},"–û—Ç–ø—Ä–∞–≤–∏—Ç—å")])])):c("",!0)],2)}const Q=f(y,[["render",H],["__scopeId","data-v-73e61073"]]);export{Q as P};
